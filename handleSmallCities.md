# handleSmallCities 함수 로직

## 소도시 등록
- `newUnitLoop`에서 새 유닛이 생성될 때 유닛 타입이 `소도시`면 `skill.newCity()`를 호출한다.
- `newCity` 함수는 도시 좌표를 `cityMaps`에 기록하고, 해당 유닛을 `smallCityGroup`에 추가한다.

## 소도시 상태 처리
- `handleSmallCities`는 `smallCityGroup`의 모든 소도시를 순회하며 상태를 갱신한다.
- 유닛이 파괴되면 도시 좌표를 `cityMaps`에서 제거한다.
- 각 소도시의 위치를 기준으로 `Defender` 지역을 설정하여 주둔군을 배치할 범위를 정의한다.

## 주둔군 생성
- 소도시가 공격 명령(`orderId` 19)과 초기 상태(`state` 0)를 가지면 전투가 시작된다.
- 도시의 실드 값을 `DEFENDER_PER_SHIELD`만큼 소모하면서 해당 수만큼 `주둔군` 유닛을 생성한다.
- 전투가 시작되면 도시 상태를 400으로 설정해 전투 타이머를 초기화한다.

## 주둔군 흡수
- 방어 명령(`orderId` 18)과 상태 1이 동시에 충족되면 기존 `주둔군`을 모두 제거하고 실드로 환산한다.
- 이전에 설정된 위치의 캐시(`Map Revealer`)를 삭제한 뒤 `주둔군`을 하나씩 제거하며 실드를 회복한다.
- 완료 후 상태를 0으로 초기화한다.

## 전투 상태 관리
- 도시 상태가 1보다 크면 전투 타이머를 관리한다.
- 공격 명령이 유지되면 타이머를 400으로 재설정하고, 그렇지 않으면 매 프레임마다 1씩 감소시킨다.
